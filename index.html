<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>XPool - Object Pooling System for Unity | XPool </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="XPool - Object Pooling System for Unity | XPool ">
    <meta name="generator" content="docfx 2.59.3.0">
    
    <link rel="shortcut icon" href="favicon.ico">
    <link rel="stylesheet" href="styles/docfx.vendor.css">
    <link rel="stylesheet" href="styles/docfx.css">
    <link rel="stylesheet" href="styles/main.css">
    <meta property="docfx:navrel" content="toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    
    <meta property="docfx:rel" content="">
    <meta property="docfx:newtab" content="true">
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="index.html">
                <img id="logo" class="svg" src="logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first="First" data-prev="Previous" data-next="Next" data-last="Last"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        <div class="article row grid">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="xpool---object-pooling-system-for-unity">XPool - Object Pooling System for Unity</h1>

<p><a href="https://github.com/mackysoft/XPool/actions/workflows/tests.yaml"><img src="https://github.com/mackysoft/XPool/actions/workflows/tests.yaml/badge.svg" alt="Tests"></a> <a href="https://github.com/mackysoft/XPool/actions/workflows/build.yaml"><img src="https://github.com/mackysoft/XPool/actions/workflows/build.yaml/badge.svg" alt="Build"></a> <a href="https://github.com/mackysoft/XPool/releases"><img src="https://img.shields.io/github/v/release/mackysoft/XPool" alt="Release"></a> <a href="https://openupm.com/packages/com.mackysoft.xpool/"><img src="https://img.shields.io/npm/v/com.mackysoft.xpool?label=openupm&amp;registry_uri=https://package.openupm.com" alt="openupm"></a></p>
<p><img src="https://user-images.githubusercontent.com/13536348/154980636-f949151e-f820-4d86-b9e9-302880671d14.png" alt="XPool_Frame"></p>
<p><strong>Created by Hiroya Aramaki (<a href="https://twitter.com/makihiro_dev">Makihiro</a>)</strong></p>
<h2 id="what-is-xpool-">What is XPool ?</h2>
<p>XPool is an object pooling library for Unity.</p>
<p>This was developed to be able to do all the pooling expected in application development with just this library.</p>
<ul>
<li>All your classes can be pooled.</li>
<li>Short code, easy to use.</li>
<li>Fast performance</li>
<li>Scalability</li>
<li>Tested. It works stably.</li>
</ul>
<h2 id="a-idindex-hrefindex-table-of-contents-a"><a id="index" href="#index"> Table of Contents </a></h2>
<ul>
<li><a href="#installation">📥 Installation</a></li>
<li><a href="#usage">🔰 Usage</a><ul>
<li><a href="#unity-object-pool">Unity Object Pool</a><ul>
<li><a href="#particle-system-pool">ParticleSystem Pool</a></li>
</ul>
</li>
<li><a href="#object-pool">Pure C# Object Pool</a></li>
<li><a href="#collection-pool">Collection Pool</a></li>
<li><a href="#non-allocated-collections">Non Allocated Collections</a></li>
<li><a href="#how-to-write-custom-pool">How to write custom pool ?</a><ul>
<li><a href="#particle-system-pool-implementation">ParticleSystemPool implementation</a></li>
</ul>
</li>
<li><a href="#optimization">Optimization</a></li>
</ul>
</li>
<li><a href="#help-and-contribute">✉ Help &amp; Contribute</a></li>
<li><a href="#author-info">📔 Author Info</a></li>
<li><a href="#license">📜 License</a></li>
</ul>
<h1 id="a-idinstallation-hrefinstallation--installation-a"><a id="installation" href="#installation"> 📥 Installation </a></h1>
<p>Download any version from releases.</p>
<p>Releases: <a href="https://github.com/mackysoft/XPool/releases">https://github.com/mackysoft/XPool/releases</a></p>
<h3 id="install-via-packagemanager">Install via PackageManager</h3>
<p>Or, you can add this package by opening PackageManager and entering</p>
<p><code>https://github.com/mackysoft/XPool.git?path=Assets/MackySoft/MackySoft.XPool</code></p>
<p>from the <code>Add package from git URL</code> option.</p>
<h3 id="install-via-open-upm">Install via Open UPM</h3>
<p>Or, you can install this package from the <a href="https://openupm.com/packages/com.mackysoft.xpool/">Open UPM</a> registry.</p>
<p>More details <a href="https://openupm.com/">here</a>.</p>
<pre><code>openupm add com.mackysoft.xpool
</code></pre><h1 id="a-idusage-hrefusage--usage-a"><a id="usage" href="#usage"> 🔰 Usage </a></h1>
<p>The full Scripting API is <a href="https://mackysoft.github.io/XPool/api/MackySoft.XPool.html">here</a>.</p>
<p>Scripting API: <a href="https://mackysoft.github.io/XPool/api/MackySoft.XPool.html">https://mackysoft.github.io/XPool/api/MackySoft.XPool.html</a></p>
<h2 id="a-idunity-object-pool-hrefunity-object-pool-unity-object-pool-gameobject-component-a"><a id="unity-object-pool" href="#unity-object-pool"> Unity Object Pool (GameObject, Component) </a></h2>
<p>Pooling of Unity Object (GameObject, Component) can be performed using <code>GameObjectPool</code> or <code>ComponentPool&lt;T&gt;</code>.
These hierarchical objects can be rented by writing them in a similar way to <code>Instantiate</code> method.</p>
<pre><code class="lang-cs">// Example code is being written...
</code></pre><!--
```cs
public class Projectile : MonoBehaviour {

    public float speed;
    public event Action OnHit;

    void Update () {
        transform.Translate(Vector3.forward * speed * Time.deltaTime);
    }

    void OnCollisionEnter (Collision collision) {
        OnHit?.Invoke();
    }
}

public class OnHitTrigger : MonoBehaviour {
    public void Initialize (Projectile projectile,IPool<Projectile> pool) {
        projectile.OnHit += () => pool.Return(projectile);
    }


}

public class Shooter : MonoBehaviour {

    [SerializeField]
    ComponentPool<Projectile> m_ProjectilePool = new ComponentPool<Projectile>();

    void Awake () {
        m_ProjectilePool.OnCreate = instance => instance.gameObject.AddComponent<OnHitTrigger>();
        m_ProjectilePool.OnRent = instance => instance.gameObject.SetActive(true);
        m_ProjectilePool.OnRetuern = instance => instance.gameObject.SetActive(false);
        m_ProjectilePool.OnRelease = instance => Destroy(instance.gameObject);
    }

    public void Shoot (){
        Projectile instance = m_ProjectilePool.Rent(transform.position,transform.rotation);
        instance.OnHit += () => 
    }
}
```
-->
<h3 id="a-idparticle-system-pool-hrefparticle-system-pool-particlesystem-pool-a"><a id="particle-system-pool" href="#particle-system-pool"> ParticleSystem Pool </a></h3>
<p>Optimized pools are available for some of the components implemented in Unity.</p>
<p>This is an example of <code>ParticleSystemPool</code> usage.</p>
<pre><code class="lang-cs">public class HitParticleSystemEmitter : MonoBehaviour {

    [SerializeField]
    ParticleSystemPool m_HitParticleSystemPool = new ParticleSystemPool();

    void OnCollisionEnter (Collision collision) {
        // The rented ParticleSystem is automatically returned to the pool when completed.
        m_HitParticleSystemPool.Rent(collision.contacts[0],Quaternion.identity);
    }
}
</code></pre><p>If you need an optimized pool for other components, please refer to the <a href="#how-to-write-custom-pool">How to write custom pool ?</a> section, or give me feedback via <a href="https://github.com/mackysoft/XPool/issues">issues</a> or <a href="https://github.com/mackysoft/XPool/pulls">pull requests</a>.</p>
<h2 id="a-idobject-pool-hrefobject-pool-object-pool-pure-c-object-a"><a id="object-pool" href="#object-pool"> Object Pool (Pure C# Object) </a></h2>
<p><code>FactoryPool&lt;T&gt;</code> can be used to pool Pure C# Object.</p>
<blockquote><p>Unity Object are not supported, as they behave differently from Pure C# Object in that they can be set to null externally with <code>Destroy</code> method.</p>
</blockquote>
<pre><code class="lang-cs">// Give the capacity and factory method to the constructor.
var pool = new FactoryPool&lt;MyClass&gt;(8,() =&gt; new MyClass());

// Create new instance by factory if pool is empty.
MyClass instance = pool.Rent();

// Return instance to the pool.
pool.Return(instance);
</code></pre><h2 id="a-idcollection-pool-hrefcollection-pool-collection-pool-t-listt-qeueuet-stackt-hashsett-dictionarytkeytvalue-a"><a id="collection-pool" href="#collection-pool"> Collection Pool (<code>T[]</code>, <code>List&lt;T&gt;</code>, <code>Qeueue&lt;T&gt;</code>, <code>Stack&lt;T&gt;</code>, <code>HashSet&lt;T&gt;</code>, <code>Dictionary&lt;TKey,TValue&gt;</code>) </a></h2>
<p>An optimized pool is provided for the generic collections provided in .NET Framework.</p>
<pre><code class="lang-cs">// Rent an array from the pool. 
// Note that the array length to be rented is the next two powers of minimumLength.
T[] array = ArrayPool&lt;T&gt;.Shared.Rent(minimumLength: 10);

// Return array to the pool.
ArrayPool&lt;T&gt;.Shared.Return(array);

// ListPool&lt;T&gt;, QueuePool&lt;T&gt;, StackPool&lt;T&gt;, HashSetPool&lt;T&gt;, DictionaryPool&lt;TKey,TValue&gt; are also available.
List&lt;T&gt; list = ListPool&lt;T&gt;.Shared.Rent();
Queue&lt;T&gt; queue = QueuePool&lt;T&gt;.Shared.Rent();
Stack&lt;T&gt; stack = StackPool&lt;T&gt;.Shared.Rent();
HashSet&lt;T&gt; hashSet = HashSetPool&lt;T&gt;.Shared.Rent();
Dictionary&lt;TKey,TValue&gt; dictionary = DictionaryPool&lt;TKey,TValue&gt;.Shared.Rent();
</code></pre><h2 id="a-idnon-allocated-collections-hrefnon-allocated-collections-non-allocated-collections-a"><a id="non-allocated-collections" href="#non-allocated-collections"> Non allocated collections </a></h2>
<p>You can use the TemporaryCollections API that leverages <code>ArrayPool&lt;T&gt;</code>.</p>
<p>These collections are a struct and internally use array rented from <code>ArrayPool&lt;T&gt;</code>.</p>
<p>Therefore, it is fast and non-allocation.</p>
<pre><code class="lang-cs">// Create a temporary array.
var array = TemporaryArray&lt;T&gt;.Create(10);

// You must release collection when you are done using it.
array.Dispose();

// TemporaryList&lt;T&gt;, TemporaryQueue&lt;T&gt;, TemporaryStack&lt;T&gt; are also available.
TemporaryList&lt;T&gt; list = TemporaryList&lt;T&gt;.Create();
TemporaryQueue&lt;T&gt; queue = TemporaryQueue&lt;T&gt;.Create();
TemporaryStack&lt;T&gt; stack = TemporaryStack&lt;T&gt;.Create();
</code></pre><h2 id="a-idhow-to-write-custom-pool-hrefhow-to-write-custom-pool-how-to-write-custom-pool--a"><a id="how-to-write-custom-pool" href="#how-to-write-custom-pool"> How to write custom pool ? </a></h2>
<p>If you want to implement a more customized pool, you can quickly create one by using the provided base classes.</p>
<p>The base class of the pool is in the <code>ObjectModel</code> namespace.</p>
<ul>
<li><code>MackySoft.XPool.ObjectMode.PoolBase&lt;T&gt;</code></li>
<li><code>MackySoft.XPool.Unity.ObjectModel.UnityObjectPoolBase&lt;T&gt;</code></li>
<li><code>MackySoft.XPool.Unity.ObjectModel.ComponentPoolBase&lt;T&gt;</code></li>
</ul>
<pre><code class="lang-cs">using MackySoft.XPool.ObjectModel; // PoolBase&lt;T&gt; is here.

public class MyPool : PoolBase&lt;MyClass&gt; {

    public MyPool () {
    }

    public MyPool (MyClass original,int capacity) : base(original,capacity) {
    }

    // Called when Rent is invoked and there are no instances in the pool.
    protected override MyClass Factory () {
        return new MyClass();
    }

    // Called when an instance is rented from the pool.
    // This is also the case when a new instance is created by the Factory.
    protected override void OnRent (MyClass instance) {

    }

    // Called when an instance is returned to the pool.
    protected override void OnReturn (MyClass instance) {

    }

    // Called when the capacity is exceeded and the instance cannot be returned to the pool,
    // or when the instance is released by the ReleaseInstances method.
    protected override void OnRelease (MyClass instance) {

    }
}
</code></pre><h3 id="a-idparticle-system-pool-implementation-hrefparticle-system-pool-implementation-particlesystempool-implementation-a"><a id="particle-system-pool-implementation" href="#particle-system-pool-implementation"> ParticleSystemPool implementation </a></h3>
<p>As an example, <code>ParticleSystemPool</code> is implemented using <code>ComponentPoolBase&lt;T&gt;</code>.
Its functionality has been optimized for ParticleSystem.</p>
<pre><code class="lang-cs">using System;
using UnityEngine;
using MackySoft.XPool.Unity.ObjectModel; // ComponentPoolBase&lt;T&gt; is here.

[Serializable]
public class ParticleSystemPool : ComponentPoolBase&lt;ParticleSystem&gt; {

    [SerializeField]
    bool m_PlayOnRent;

    public bool PlayOnRent { get =&gt; m_PlayOnRent; set =&gt; m_PlayOnRent = value; }

    public ParticleSystemPool () {
    }

    public ParticleSystemPool (ParticleSystem original,int capacity) : base(original,capacity) {
    }

    protected override void OnCreate (ParticleSystem instance) {
        var main = instance.main;
        main.stopAction = ParticleSystemStopAction.Callback;
        var trigger = instance.gameObject.AddComponent&lt;ParticleSystemStoppedTrigger&gt;();
        trigger.Initialize(instance,this);
    }

    protected override void OnRent (ParticleSystem instance) {
        if (m_PlayOnRent) {
            instance.Play(true);
        }
    }

    protected override void OnReturn (ParticleSystem instance) {
        instance.Stop(true,ParticleSystemStopBehavior.StopEmitting);
    }

    protected override void OnRelease (ParticleSystem instance) {
        UnityEngine.Object.Destroy(instance.gameObject);
    }

    public class ParticleSystemStoppedTrigger : MonoBehaviour {

        ParticleSystem m_ParticleSystem;
        IPool&lt;ParticleSystem&gt; m_Pool;

        internal void Initialize (ParticleSystem ps,IPool&lt;ParticleSystem&gt; pool) {
            m_ParticleSystem = ps;
            m_Pool = pool;
        }

        void OnParticleSystemStopped () {
            m_Pool?.Return(m_ParticleSystem);
        }

    }
}
</code></pre><h1 id="a-idhelp-and-contribute-hrefhelp-and-contribute--help--contribute-a"><a id="help-and-contribute" href="#help-and-contribute"> ✉ Help &amp; Contribute </a></h1>
<p>I welcome feature requests and bug reports in <a href="https://github.com/mackysoft/XPool/issues">issues</a> and <a href="https://github.com/mackysoft/XPool/pulls">pull requests</a>.</p>
<p>If you feel that my works are worthwhile, I would greatly appreciate it if you could sponsor me.</p>
<p>GitHub Sponsors: <a href="https://github.com/sponsors/mackysoft">https://github.com/sponsors/mackysoft</a></p>
<h1 id="a-idauthor-info-hrefauthor-info--author-info-a"><a id="author-info" href="#author-info"> 📔 Author Info </a></h1>
<p>Hiroya Aramaki is a indie game developer in Japan.</p>
<ul>
<li>Twitter: <a href="https://twitter.com/makihiro_dev">https://twitter.com/makihiro_dev</a></li>
<li>Blog: <a href="https://mackysoft.net/blog">https://mackysoft.net/blog</a></li>
</ul>
<h1 id="a-idlicense-hreflicense--license-a"><a id="license" href="#license"> 📜 License </a></h1>
<p>This library is under the MIT License.</p>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
                <h5>In This Article</h5>
                <div></div>
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            XPool - Object Pooling System
            
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="styles/docfx.js"></script>
    <script type="text/javascript" src="styles/main.js"></script>
  </body>
</html>
